<div class="container heading">
  <h1>Messages</h1>
</div>
<div class="container">
  <div class="grid">
    <div class="lg:col-12 md:col-12 sm:col-12 xl:col-12">
      <div class="flex flex-row flex-wrap card-container blue-container">
        <div
          class="p-field-checkbox flex align-items-center justify-content-center m-3"
        >
          <p-checkbox
            name="groupname"
            value="unread"
            inputId="unread"
            class="mr-1"
            (click)="userUnreadMessages('Unread')"
          ></p-checkbox>
          <label for="unread">Unread</label>
        </div>
        <div
          class="p-field-checkbox flex align-items-center justify-content-center m-2"
        >
          <p-checkbox
            name="groupname"
            value="important"
            inputId="important"
            class="mr-1"
            (click)="userImportantMessages('Important')"
          ></p-checkbox>
          <label for="important">Important</label>
        </div>
        <div
          class="p-field-checkbox flex align-items-center justify-content-center m-2"
        >
          <p-checkbox
            name="groupname"
            value="notanswered"
            inputId="notanswered"
            class="mr-1"
            (click)="userNotAnsweredMessages('No response')"
          ></p-checkbox>
          <label for="notanswered">Not answered</label>
        </div>
        <div
          class="p-field-checkbox flex align-items-center justify-content-center m-2"
        >
          <p-checkbox
            name="groupname"
            value="showautomatedmessages"
            inputId="showmsgs"
            class="mr-1"
            (click)="userAutomatedMessages('automated')"
          ></p-checkbox>
          <label for="showmsgs">Show automated messages</label>
        </div>
        <div
          class="p-field-checkbox flex align-items-center justify-content-center m-2"
        >
          Sortby:<p-multiSelect
            [options]="multiSelectMessages"
            optionLabel="name"
            defaultLabel="Select"
            name="multiselectmessages"
            [(ngModel)]="selectedMultiMsgs"
          ></p-multiSelect>
        </div>
        <div
          class="p-field-checkbox flex align-items-center justify-content-center ml-7"
        >
          <button
            pButton
            type="button"
            label="Compose"
            [ngStyle]="{backgroundColor:'var(--green-800)'}"
            (click)="showDialog()"
          ></button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="container-fluid">
  <div class="grid">
    <div class="lg:col-5 m-0">
      <div class="card p-5" [style]="{ height: '550px' }">
        <div class="grid">
          <div class="lg:col-12">
            <span class="p-input-icon-right">
              <i class="pi pi-search"></i>
              <input
                type="text"
                pInputText
                placeholder="Search by keyword"
                [ngStyle]="{ width: '100%' }"
                (input)="
                  users.filterGlobal($any($event.target).value, 'contains')
                "
              />
            </span>
          </div>

          <div class="lg:col-12">
            <div class="users">
              <p-table
                class="p-table"
                #users
                [value]="tempMessageUsers"
                [globalFilterFields]="['name']"
              >
                <ng-template pTemplate="body" let-user>
                  <tr (click)="onUserMessageSelect(user)">
                    <td>
                      <p-avatar
                        image="{{ user.image }}"
                        shape="circle"
                      ></p-avatar
                      ><br />
                    </td>
                    <td class="messagse">
                      <p>
                        {{ user.message }}
                      </p>
                      <h3>{{ user.name }}</h3>
                    </td>
                    <td class="mb-3 w-100">
                      <!-- <p-checkbox [(ngModel)]="importnatSelectedMessages" name="importantMessages" value="{{user}}"></p-checkbox> -->
                      <!-- <input type="checkbox"  name="" id="" (change)="importantMessage(user,user.ID)"> -->
                      <p>
                        <small>{{ user.date }}</small>
                      </p>
                    </td>
                  </tr>
                </ng-template>
              </p-table>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="lg:col-7">
      <div class="card p-5" *ngIf="selectedMessage">
        <div class="lg:col-12">
          <div class="grid border-bottom p-2">
            <div class="col:lg-10">
              <h2>{{ selectedMessage.name }} conversation with instructor</h2>
            </div>
            <div class="col:lg-2">
              <div class="ml-5 p-2">
                <i class="pi pi-ellipsis-v"></i>
              </div>
            </div>
          </div>
        </div>
        <div class="lg:col-12">
          <div class="messages">
            <h3 class="text-center">{{ selectedMessage.date }}</h3>
            <div
              class="grid"
              [style]="{ width: '100%', 'justify-content': 'center' }"
            >
              <div class="col:lg-3">
                <img
                  src="{{ selectedMessage.image }}"
                  alt=""
                  width="50px"
                  height="50px"
                  class="rounded-circle"
                />
              </div>

              <div class="col:lg-6 p-1">
                <h1 class="d-inline p-2">
                  {{ selectedMessage.name }} with Instructor
                </h1>
                <p class="d-inline ml-3">7:30 AM</p>
              </div>
              <div class="col:lg-3">
                <p class="p-5 messages-paragraph">
                  {{ selectedMessage.message }} <br /><br />
                  Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                  Porro voluptas amet, obcaecati natus ut ipsam accusamus unde
                  nulla omnis voluptatum magni officiis modi quisquam possimus.
                  <br />
                  <br />

                  Lorem ipsum dolor sit amet consectetur, adipisicing elit.
                  Esse, recusandae.
                </p>
              </div>
              <!-- message from instructor -->
              <div
                class="grid bg-light"
                *ngIf="instructorMessage"
                [style]="{ width: '100%', 'justify-content': 'center' }"
              >
                <div class="col:lg-3 mt-3">
                  <img
                    src="{{ selectedMessage.image }}"
                    alt=""
                    width="50px"
                    height="50px"
                    class="rounded-circle"
                  />
                </div>

                <div class="col:lg-9 p-1 mt-3">
                  <h1 class="d-inline p-2">Instructor</h1>
                  <p class="d-inline ml-3">6:30 AM</p>
                </div>
                <div class="col:lg-12">
                  <div class="instructormessage">
                    <p
                      [innerHTML]="textMessageFromInstructorFinal"
                    ></p>
                    Lorem, ipsum dolor sit amet consectetur adipisicing elit.
                    Porro voluptas amet, obcaecati natus ut ipsam accusamus unde
                    nulla omnis voluptatum magni officiis modi quisquam possimus.
                    <br />
                    <br />
  
                    Lorem ipsum dolor sit amet consectetur, adipisicing elit.
                    Esse, recusandae.
                  </div>
                </div>
                <!-- message from instructor -->
              </div>
            </div>
          </div>
        </div>
        <div class="lg:col-12">
          <textarea
            rows="5"  
            pInputTextarea
            autoResize="autoResize"
            [ngStyle]="{ border: 'none', padding: '2',width:'100%' }"
            placeholder="Type your message here..."
            [(ngModel)]="textMessageFromInstructor"
            name="textmessage"
          ></textarea>
          <div class="flex mt-2 ">
            <input
             class="float-end"
              type="button"
              value="Send"
              (click)="messageFromInstructor()"
              class="position-absolute bottom-0 end-0 p-2 mb-1  w-2 mr-6"
            />
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- dialog for compose -->
<p-dialog [(visible)]="displayDialog" [style]="{ width: '700px' }">
  <div class="container heading">
    <h1>New Message</h1>
  </div>
  <form >
    <div class="d-flex justify-space-between">
     <h2>To:</h2>
      <input
        id="firstname1"
        type="text"
        name="searchusers"
        [(ngModel)]="selectedMessage.name"
        class="p-2 mb-2 w-11"
        [style]="{ border: '2px solid black' }"
      />
    </div>
    <div>
      <p-editor
        [(ngModel)]="messageFromCompose"
        styleClass="ql-editor"
        name="ql-editor"
        [style]="{ height: '150px', border: '2px solid black',width:'100%' }"
      >
        <ng-template pTemplate="header">
          <span class="ql-formats">
            <button type="button" class="ql-bold" aria-label="Bold"></button>
            <button
              type="button"
              class="ql-italic"
              aria-label="Italic"
            ></button>
            <button
              type="button"
              class="ql-underline"
              aria-label="Underline"
            ></button>
            <button type="button" class="ql-image" aria-label="Image"></button>
          </span>
        </ng-template>
      </p-editor>
    </div>
    <div class="flex">
      <input
       class="flex-end"
        type="button"
        value="Send"
        (click)="messageFromComposer()"
        class="position-absolute bottom-0 end-0 p-2 w-2 mr-6"
      />
    </div>
  </form>
</p-dialog>
